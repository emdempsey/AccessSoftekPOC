{
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "BetaAppNSGName": {
      "type": "string"
    },
    "BetaAppSubnetAddressPrefix": {
      "type": "string"
    },
    "BetaDataNSGName": {
      "type": "string"
    },
    "BetaDataSubnetAddressPrefix": {
      "type": "string"
    },
    "BetaWebNSGName": {
      "type": "string"
    },
    "BetaWebSubnetAddressPrefix": {
      "type": "string"
    },
    "DevAppNSGName": {
      "type": "string"
    },
    "DevAppSubnetAddressPrefix": {
      "type": "string"
    },
    "DevBetaMgmtNSGName": {
      "type": "string"
    },
    "DevBetaMgmtSubnetAddressPrefix": {
      "type": "string"
    },
    "DevDataNSGName": {
      "type": "string"
    },
    "DevDataSubnetAddressPrefix": {
      "type": "string"
    },
    "DevWebNSGName": {
      "type": "string"
    },
    "DevWebSubnetAddressPrefix": {
      "type": "string"
    },
    "location": {
      "type": "string"
    },
    "ProdAppNSGName": {
      "type": "string"
    },
    "ProdAppSubnetAddressPrefix": {
      "type": "string"
    },
    "ProdDataNSGName": {
      "type": "string"
    },
    "ProdDataSubnetAddressPrefix": {
      "type": "string"
    },
    "ProdWebNSGName": {
      "type": "string"
    },
    "ProdWebSubnetAddressPrefix": {
      "type": "string"
    },
    "PubNSGName": {
      "type": "string"
    },
    "PubSubnetAddressPrefix": {
      "type": "string"
    },
    "StgAppNSGName": {
      "type": "string"
    },
    "StgAppSubnetAddressPrefix": {
      "type": "string"
    },
    "StgDataNSGName": {
      "type": "string"
    },
    "StgDataSubnetAddressPrefix": {
      "type": "string"
    },
    "StgProdMgmtNSGName": {
      "type": "string"
    },
    "StgProdMgmtSubnetAddressPrefix": {
      "type": "string"
    },
    "StgWebNSGName": {
      "type": "string"
    },
    "StgWebSubnetAddressPrefix": {
      "type": "string"
    }
  },
  "variables": {
  },
  "resources": [
    //Public security policies
    {
      "apiVersion": "2015-05-01-preview",
      "type": "Microsoft.Network/networkSecurityGroups",
      "name": "[parameters('PubNSGName')]",
      "location": "[parameters('location')]",
      "tags": {
        "displayName": "Public NSG"
      },
      "properties": {
        "securityRules": [
          {
            "name": "HTTP_Inbound_Internet",
            "properties": {
              "description": "This rule allows inbound HTTP traffic from the internet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "Internet",
              "destinationPortRange": "80",
              "destinationAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Inbound",
              "priority": 100
            }
          },
          {
            "name": "HTTPS_Inbound_Internet",
            "properties": {
              "description": "This rule allows inbound HTTP traffic from the internet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "Internet",
              "destinationPortRange": "443",
              "destinationAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Inbound",
              "priority": 101
            }
          },
          {
            "name": "HTTP_Outbound_DevWeb",
            "properties": {
              "description": "This rule allows outbound HTTP traffic to the Dev Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "80",
              "destinationAddressPrefix": "[parameters('DevWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 201
            }
          },
          {
            "name": "HTTPS_Outbound_DevWeb",
            "properties": {
              "description": "This rule allows outbound HTTPS traffic to the Dev Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "443",
              "destinationAddressPrefix": "[parameters('DevWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 202
            }
          },
          {
            "name": "HTTP_Outbound_BetaWeb",
            "properties": {
              "description": "This rule allows outbound HTTP traffic to the Beta Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "80",
              "destinationAddressPrefix": "[parameters('BetaWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 203
            }
          },
          {
            "name": "HTTPS_Outbound_BetaWeb",
            "properties": {
              "description": "This rule allows outbound HTTPS traffic to the Beta Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "443",
              "destinationAddressPrefix": "[parameters('BetaWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 204
            }
          },
          {
            "name": "HTTP_Outbound_StgWeb",
            "properties": {
              "description": "This rule allows outbound HTTP traffic to the Stg Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "80",
              "destinationAddressPrefix": "[parameters('StgWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 205
            }
          },
          {
            "name": "HTTPS_Outbound_StgWeb",
            "properties": {
              "description": "This rule allows outbound HTTPS traffic to the Stg Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "443",
              "destinationAddressPrefix": "[parameters('StgWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 206
            }
          },
          {
            "name": "HTTP_Outbound_ProdWeb",
            "properties": {
              "description": "This rule allows outbound HTTP traffic to the Prod Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "80",
              "destinationAddressPrefix": "[parameters('ProdWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 207
            }
          },
          {
            "name": "HTTPS_Outbound_ProdWeb",
            "properties": {
              "description": "This rule allows outbound HTTPS traffic to the Prod Web Subnet",
              "protocol": "Tcp",
              "sourcePortRange": "*",
              "sourceAddressPrefix": "[parameters('PubSubnetAddressPrefix')]",
              "destinationPortRange": "443",
              "destinationAddressPrefix": "[parameters('ProdWebSubnetAddressPrefix')]",
              "access": "Allow",
              "direction": "Outbound",
              "priority": 208
            }
          }
        ]
      }
    }
    //Dev security policies
    //Beta security policies
    //Stg security policies
    //Prod security policies
    //DevBeta Mgmt security policies
    //StgProd Mgmt security policies
  ]
}
